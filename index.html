<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Polished Clicker â€” ðŸ›’ Shop</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#7c3aed; --glass:rgba(255,255,255,0.04);
      --muted:rgba(255,255,255,0.6);
    }
    *{box-sizing:border-box}
    html,body{height:100%;}
    body{
      margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(124,58,237,0.12), transparent),
                  radial-gradient(900px 500px at 90% 90%, rgba(14,165,233,0.06), transparent),
                  var(--bg); color:#e6eef8; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      display:flex; align-items:center; justify-content:center; padding:32px;
    }

    .app{
      width:1100px; max-width:100%; min-height:600px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:16px; box-shadow:0 10px 30px rgba(2,6,23,0.7); overflow:hidden; display:grid; grid-template-columns:1fr 380px;
    }

    /* Left area (game) */
    .game {
      padding:36px; display:flex; flex-direction:column; gap:18px;
    }
    .header{display:flex; align-items:center; justify-content:space-between}
    .title{font-weight:800; font-size:20px; letter-spacing:-0.02em}
    .sub{color:var(--muted); font-size:13px}

    .panel{background:var(--card); border-radius:12px; padding:18px; box-shadow:inset 0 1px 0 rgba(255,255,255,0.02);}

    .stats{display:flex; gap:12px; align-items:center}
    .stat{flex:1}
    .stat h3{margin:0; font-size:18px}
    .stat p{margin:6px 0 0; color:var(--muted); font-size:12px}

    .click-area{display:flex; align-items:center; justify-content:center; flex-direction:column; gap:14px; padding:28px}
    .big-button{
      width:340px; max-width:86%; height:120px; border-radius:16px; display:flex; align-items:center; justify-content:center;
      font-weight:800; font-size:34px; letter-spacing:0.02em; cursor:pointer; user-select:none;
      background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.04);
      box-shadow:0 8px 30px rgba(124,58,237,0.12), 0 2px 8px rgba(2,6,23,0.6); transition:transform .08s ease, box-shadow .12s ease;
    }
    .big-button:active{transform:translateY(2px) scale(0.996); box-shadow:0 6px 20px rgba(124,58,237,0.09)}
    .per-click{color:var(--muted); font-size:14px}

    /* Right area (shop) */
    .shop-panel{padding:18px; background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent); border-left:1px solid rgba(255,255,255,0.02);}
    .shop-title{display:flex; align-items:center; justify-content:space-between}
    .shop-list{margin-top:18px; display:flex; flex-direction:column; gap:12px}
    .item{display:flex; gap:12px; align-items:center; padding:12px; border-radius:10px; background:var(--glass);}
    .item .meta{flex:1}
    .item h4{margin:0; font-size:15px}
    .price{font-weight:700}
    .buy-btn{background:linear-gradient(90deg,var(--accent), #5b21b6); border:none; padding:8px 12px; color:white; border-radius:8px; cursor:pointer}
    .buy-btn:disabled{opacity:0.4; cursor:not-allowed}

    /* Floating shop button (left) */
    .shop-toggle{
      position:fixed; left:20px; top:50%; transform:translateY(-50%); z-index:80;
    }
    .shop-toggle button{display:flex; align-items:center; gap:10px; background:var(--accent); border:none; padding:12px 16px; color:white; border-radius:12px; cursor:pointer; box-shadow:0 10px 30px rgba(124,58,237,0.16)}

    .toast{position:fixed; left:50%; transform:translateX(-50%); bottom:30px; background:rgba(0,0,0,0.6); color:white; padding:10px 14px; border-radius:8px; display:none}

    .footer{margin-top:auto; font-size:12px; color:var(--muted); display:flex; gap:12px; align-items:center; justify-content:space-between}

    .muted{color:var(--muted)}
    .small{font-size:12px}

    /* Responsive */
    @media (max-width:980px){ .app{grid-template-columns:1fr} .shop-panel{order:2} .shop-toggle{left:12px} }
  </style>
</head>
<body>
  <div class="shop-toggle">
    <button id="shopToggle">ðŸ›’ Shop</button>
  </div>

  <div class="app" role="application" aria-label="Clicker game">
    <div class="game">
      <div class="header">
        <div>
          <div class="title">Cosmic Clicks</div>
          <div class="sub">Click to earn â€” buy upgrades & auto-clickers</div>
        </div>
        <div class="sub small muted">Saved locally â€¢ Progress auto-saves</div>
      </div>

      <div class="panel stats">
        <div class="stat">
          <h3 id="counter">0</h3>
          <p>Coins</p>
        </div>
        <div class="stat">
          <h3 id="perClick">1</h3>
          <p>Per Click</p>
        </div>
        <div class="stat">
          <h3 id="income">0 / s</h3>
          <p>Auto Income</p>
        </div>
      </div>

      <div class="panel click-area">
        <div class="big-button" id="clickBtn" role="button" aria-pressed="false">Tap</div>
        <div class="per-click">You earn <strong id="pcDisplay">1</strong> per click</div>
      </div>

      <div class="panel footer">
        <div>Upgrades owned: <span id="upgradesOwned">0</span></div>
        <div class="muted">Built-in prestige not included</div>
      </div>
    </div>

    <aside class="shop-panel panel" id="shopPanel">
      <div class="shop-title">
        <div>
          <div style="font-weight:800; font-size:16px">Shop</div>
          <div class="sub">Buy upgrades to boost clicks & automate</div>
        </div>
        <div class="small muted">Coins: <span id="coinsMini">0</span></div>
      </div>

      <div class="shop-list" id="shopList">
        <!-- Items will be injected here -->
      </div>

      <div style="margin-top:14px; display:flex; gap:8px; align-items:center;">
        <button id="resetBtn" class="buy-btn" style="background:transparent; color:var(--muted); border:1px solid rgba(255,255,255,0.03)">Reset Progress</button>
        <div class="muted small">Autosave Â· LocalStorage</div>
      </div>
    </aside>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    // Game state
    const defaultState = {
      coins: 0,
      perClick: 1,
      upgrades: 0,
      upgradeLevel: 0, // number of times 'double' purchased
      autos: { normal: 0, fast: 0 },
    };

    // Load / Save
    const KEY = 'polished_clicker_v1';
    function load(){
      try{ const raw=localStorage.getItem(KEY); return raw ? JSON.parse(raw) : {...defaultState}; }
      catch(e){ return {...defaultState}; }
    }
    function save(){ localStorage.setItem(KEY, JSON.stringify(state)); updateUI(); }

    const state = load();

    // DOM refs
    const counterEl = document.getElementById('counter');
    const perClickEl = document.getElementById('perClick');
    const pcDisplay = document.getElementById('pcDisplay');
    const clickBtn = document.getElementById('clickBtn');
    const incomeEl = document.getElementById('income');
    const shopList = document.getElementById('shopList');
    const coinsMini = document.getElementById('coinsMini');
    const upgradesOwned = document.getElementById('upgradesOwned');
    const shopPanel = document.getElementById('shopPanel');
    const shopToggle = document.getElementById('shopToggle');
    const toast = document.getElementById('toast');
    const resetBtn = document.getElementById('resetBtn');

    // Shop configuration
    const shopItems = [
      {
        id: 'double',
        name: 'Double Upgrade',
        desc: 'Doubles your per-click earnings. Stacks multiplicatively.',
        baseCost: 50,
        type: 'upgrade',
        buy(){
          state.upgradeLevel++;
          state.perClick *= 2;
          state.upgrades++;
        },
        cost(){ return Math.floor(50 * Math.pow(2.2, state.upgradeLevel)); }
      },
      {
        id: 'autoNorm',
        name: 'Normal Auto-Clicker',
        desc: 'Performs one click automatically every 1 second.',
        baseCost: 25,
        type: 'auto',
        speed: 1000,
        buy(){ state.autos.normal++; },
        cost(){ return Math.floor(25 * Math.pow(1.6, state.autos.normal)); }
      },
      {
        id: 'autoFast',
        name: 'Fast Auto-Clicker',
        desc: 'Performs one click automatically every 200 ms.',
        baseCost: 250,
        type: 'auto',
        speed: 200,
        buy(){ state.autos.fast++; },
        cost(){ return Math.floor(250 * Math.pow(1.55, state.autos.fast)); }
      }
    ];

    // Build shop UI
    function renderShop(){
      shopList.innerHTML = '';
      shopItems.forEach(item =>{
        const el = document.createElement('div'); el.className='item';
        el.innerHTML = `
          <div class="meta">
            <h4>${item.name}</h4>
            <div class="sub small">${item.desc}</div>
          </div>
          <div style="text-align:right">
            <div class="price">${format(item.cost())} â¨¯</div>
            <div style="margin-top:8px"><button class="buy-btn" data-id="${item.id}">Buy</button></div>
          </div>
        `;
        shopList.appendChild(el);
      });

      // Attach listeners
      shopList.querySelectorAll('.buy-btn').forEach(b=>{
        b.addEventListener('click', ()=>{
          const id = b.dataset.id;
          buyItem(id);
        });
      });
    }

    // Format
    function format(n){
      if(n>=1e9) return (n/1e9).toFixed(2)+'B';
      if(n>=1e6) return (n/1e6).toFixed(2)+'M';
      if(n>=1000) return (n/1000).toFixed(2)+'K';
      return n.toString();
    }

    // Purchase logic
    function buyItem(id){
      const item = shopItems.find(s=>s.id===id);
      const price = item.cost();
      if(state.coins < price){ showToast('Not enough coins'); shakeButton(item.id); return; }
      state.coins -= price;
      item.buy();
      showToast(`Purchased ${item.name}`);
      save();
    }

    // Click handling
    clickBtn.addEventListener('click', ()=>{
      const earned = state.perClick;
      state.coins += earned;
      pulse(clickBtn);
      animateFloating(`+${format(earned)}`);
      save();
    });

    // Auto clickers incomes
    let lastTick = Date.now();
    function tick(){
      const now = Date.now();
      const delta = now - lastTick; lastTick = now;

      // Normal autos: each adds state.perClick every 1000ms
      if(state.autos.normal>0){
        const perSecondClicks = state.autos.normal * (delta/1000);
        state.coins += perSecondClicks * state.perClick;
      }
      // Fast autos: add at speed 200ms -> delta fraction
      if(state.autos.fast>0){
        const perSecondClicks = state.autos.fast * (delta/200);
        state.coins += perSecondClicks * state.perClick;
      }

      updateUI();
    }
    setInterval(tick, 200);

    // UI updates
    function updateUI(){
      counterEl.textContent = Math.floor(state.coins);
      perClickEl.textContent = format(state.perClick);
      pcDisplay.textContent = format(state.perClick);
      coinsMini.textContent = Math.floor(state.coins);

      const autosIncome = (state.autos.normal*(1) + state.autos.fast*(1000/200)) * state.perClick; // rough per sec
      incomeEl.textContent = `${Math.round(autosIncome)}/ s`;
      upgradesOwned.textContent = state.upgrades;

      // Update shop buttons disabled state
      shopItems.forEach(item=>{
        const price = item.cost();
        const btn = document.querySelector(`[data-id='${item.id}']`);
        if(btn){ btn.disabled = state.coins < price; }
      });
    }

    // Helpers
    function showToast(text){ toast.textContent = text; toast.style.display='block'; clearTimeout(toast._h); toast._h = setTimeout(()=>{ toast.style.display='none'; },1200); }
    function pulse(el){ el.animate([{transform:'scale(1)'},{transform:'scale(1.03)'},{transform:'scale(1)'}], {duration:250}); }
    function animateFloating(text){ const f = document.createElement('div'); f.style.position='absolute'; f.style.left='50%'; f.style.top='50%'; f.style.transform='translate(-50%,-190px)'; f.style.pointerEvents='none'; f.style.fontWeight='700'; f.style.opacity='0'; f.style.zIndex=99; f.textContent = text; document.body.appendChild(f);
      const a = f.animate([{opacity:0, transform:'translate(-50%,-120px)'},{opacity:1, transform:'translate(-50%,-140px)'},{opacity:0, transform:'translate(-50%,-200px)'}], {duration:900}); a.onfinish = ()=>f.remove(); }
    function shakeButton(id){ const btn = document.querySelector(`[data-id='${id}']`); if(!btn) return; btn.animate([{transform:'translateX(0)'},{transform:'translateX(-6px)'},{transform:'translateX(6px)'},{transform:'translateX(0)'}],{duration:260}); }

    // Shop toggle
    let shopOpen = true;
    function setShop(open){ shopOpen=open; shopPanel.style.display = open ? 'block' : 'none'; shopToggle.textContent = open ? 'ðŸ›’ Shop' : 'ðŸ›’ Shop'; }
    shopToggle.addEventListener('click', ()=>{ shopOpen = !shopOpen; setShop(shopOpen); });
    // Start with shop visible on large screens, hide on small
    if(window.innerWidth < 980) setShop(false);

    // Reset
    resetBtn.addEventListener('click', ()=>{
      if(!confirm('Reset progress? This will clear local save.')) return;
      localStorage.removeItem(KEY); Object.assign(state, {...defaultState}); save(); renderShop(); updateUI(); showToast('Progress reset');
    });

    // Save periodically
    setInterval(save, 5000);

    // Initial render
    renderShop(); updateUI();

    // Keyboard support: space to click
    window.addEventListener('keydown', (e)=>{ if(e.code==='Space'){ e.preventDefault(); clickBtn.click(); } });

    // Accessibility: ARIA press on big button
    clickBtn.addEventListener('mousedown', ()=>clickBtn.setAttribute('aria-pressed','true'));
    clickBtn.addEventListener('mouseup', ()=>clickBtn.setAttribute('aria-pressed','false'));

  </script>
</body>
</html>
